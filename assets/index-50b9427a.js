import{m as g,k as w,j as i,e as n,o as l,J as C,K as k,f as e,t as c,c as m,F as b,r as B,d,R as N,E as f,L as u,g as $,i as F,h as P}from"./index-1223ee3d.js";import{_ as E}from"./BaseModal-86c9f799.js";import{a as M,b as D,d as q,f as A}from"./orderApi-62bbc7c9.js";const I=""+new URL("../icon/pay.svg",import.meta.url).href,L={class:"text-sm text-[var(--theme-text)] text-center mb-4"},O={class:"grid grid-cols-2 gap-4 w-full max-h-[300px] overflow-y-auto pr-2"},S=["onClick"],V={class:"truncate text-[var(--theme-text)]"},j={class:"mt-8 text-center"},Z={__name:"PaymentModal",props:{orderNo:{type:[Number,String],required:!0},onClose:{type:Function,required:!0}},setup(o){const a=g(),t=o,h=w();M().then(r=>{h.value=r.data.data}).catch(()=>{i(n("common.loadFailed"),null,400)});const _=()=>{t.onClose()},v=r=>{D(t.orderNo,r).then(s=>{s.data.data===!0?N.push("/dashboard"):(y({trade_no:t.orderNo,status:0,payment_url:s.data.data}),window.location.href=s.data.data)}).catch(s=>{i(s.data.message,null,400)}).finally(()=>{t.onClose()})},x=()=>{q(t.orderNo).then(()=>{i(n("common.cancelSuccess"),null,200),A().then(r=>{a.orders=r.data.data,a.orders[0]&&y({trade_no:a.orders[0].trade_no,status:a.orders[0].status})}),t.onClose()}).catch(()=>{i(n("common.cancelFailed"),n("common.cancelFailedTip"),400)})};return(r,s)=>(l(),C(E,{title:d(n)("payment.title"),"gradient-id":"payment-gradient","on-close":_},{default:k(()=>[e("p",L,c(t.orderNo),1),e("div",O,[(l(!0),m(b,null,B(h.value,p=>(l(),m("div",{key:p.id,onClick:X=>v(p.id),class:"bg-[var(--theme-com-item)] cursor-pointer px-4 py-3 rounded-lg hover:opacity-80 transition-all flex items-center gap-2"},[s[0]||(s[0]=e("img",{class:"w-5",src:I,alt:""},null,-1)),e("p",V,c(p.name),1)],8,S))),128))]),e("div",j,[e("button",{onClick:x,class:"w-[80%] p-2 bg-green-500 text-white rounded-lg hover:opacity-80 transition-opacity"},c(d(n)("payment.closeButton")),1)])]),_:1},8,["title"]))}},R=o=>{const t=f(Z,{orderNo:o,onClose:()=>{u(null,document.getElementById("modal"))}});u(t,document.getElementById("modal"))};function T(o,a){return l(),m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M8.485 2.495c.673-1.167 2.357-1.167 3.03 0l6.28 10.875c.673 1.167-.17 2.625-1.516 2.625H3.72c-1.347 0-2.189-1.458-1.515-2.625L8.485 2.495ZM10 5a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 10 5Zm0 9a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z","clip-rule":"evenodd"})])}const z={key:0,class:"fixed z-50 top-0 left-0 right-0"},H={class:"flex justify-center p-8"},J={class:"border-l-4 border-yellow-400 bg-yellow-50 p-4"},K={class:"flex"},U={class:"flex-shrink-0"},G={class:"ml-3"},Q={class:"text-sm text-yellow-700"},W={__name:"PaymentAlert",props:{orderData:{type:Object,required:!0,validator:o=>"trade_no"in o&&"status"in o},onClose:{type:Function,required:!0}},setup(o){const a=o,t=()=>{R(a.orderData.trade_no)};return(h,_)=>o.orderData.status===0?(l(),m("div",z,[e("div",H,[e("div",J,[e("div",K,[e("div",U,[$(d(T),{class:"h-5 w-5 text-yellow-400","aria-hidden":"true"})]),e("div",G,[e("p",Q,[F(c(d(n)("payment.pending"))+" ",1),e("span",{onClick:t,class:"cursor-pointer font-medium text-yellow-700 underline hover:text-yellow-600"},c(d(n)("payment.action")),1)])])])])])])):P("",!0)}},y=o=>{const t=f(W,{orderData:o,onClose:()=>{u(null,document.getElementById("alert"))}});u(t,document.getElementById("alert"))};export{R as a,y as s};
