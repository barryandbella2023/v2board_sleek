import{g as L}from"./commonApi-cf33a198.js";import{k as x,o as m,c as v,f as e,t as a,d as p,e as t,P as q,S as B,j as g,p as V,F as C,r as P,n as $,m as A,l as F,J as N,K as j,g as M,L as I,E as O,_ as Y,A as z,i as T,h as U}from"./index-1223ee3d.js";import{_ as E}from"./BaseModal-86c9f799.js";import{v as G,c as K,f as R}from"./orderApi-62bbc7c9.js";import{a as S}from"./index-50b9427a.js";const H=""+new URL("../img/banner2.png",import.meta.url).href,J=""+new URL("../icon/套餐.svg",import.meta.url).href,Q={class:"mt-4"},W={class:"text-[var(--theme-title)]"},X={class:"mt-2.5 grid grid-cols-[1fr,auto] gap-2"},Z=["placeholder"],ee={__name:"CouponInput",props:{planId:{type:[Number,String],required:!0},onCouponValidated:{type:Function,required:!0}},setup(h){const o=h,l=x(null),f=()=>{if(!l.value){g(t("plan.coupon.inputRequired"),null,400);return}G(o.planId,l.value).then(c=>{o.onCouponValidated({code:l.value,discount:c.data.data})}).catch(c=>{g(c.data.message,null,400),l.value=null})};return(c,u)=>(m(),v("div",Q,[e("p",W,a(p(t)("plan.coupon.title")),1),e("div",X,[q(e("input",{"onUpdate:modelValue":u[0]||(u[0]=_=>l.value=_),class:"bg-[var(--theme-com-item)] text-[var(--theme-text)] p-4 rounded-lg outline-none w-full",type:"text",placeholder:p(t)("plan.coupon.placeholder")},null,8,Z),[[B,l.value]]),e("button",{type:"button",onClick:f,class:"text-sm rounded-lg text-white bg-green-500 hover:opacity-80 transition-opacity px-4 whitespace-nowrap"},a(p(t)("plan.coupon.validateButton")),1)])]))}},te={class:"mt-8"},le={class:"text-[var(--theme-title)] mb-4"},ae={class:"w-full overflow-x-auto px-2 py-2"},se={class:"flex gap-4 flex-wrap"},oe=["onClick"],ne={class:"text-sm"},re={class:"font-semibold mt-1"},ie={__name:"PeriodSelector",props:{periods:{type:Array,required:!0},selectedIndex:{type:Number,required:!0},discountInfo:{type:Object,default:null},onPeriodSelect:{type:Function,required:!0}},setup(h){const o=h,l=V(()=>f=>{const c=f.number/100;return o.discountInfo?o.discountInfo.type===1?(c-o.discountInfo.value/100).toFixed(2):(c-c*o.discountInfo.value/100).toFixed(2):c.toFixed(2)});return(f,c)=>(m(),v("div",te,[e("p",le,a(p(t)("plan.period.title")),1),e("div",ae,[e("div",se,[(m(!0),v(C,null,P(h.periods,(u,_)=>(m(),v("div",{key:_,onClick:w=>h.onPeriodSelect(_),class:$(["bg-[var(--theme-com-item)] cursor-pointer px-4 py-2 rounded-lg whitespace-nowrap transition-all",h.selectedIndex===_?"ring-2 ring-green-500 text-green-500 scale-105":"text-[var(--theme-text)] hover:opacity-80"])},[e("div",ne,a(u.title),1),e("div",re,"¥"+a(l.value(u)),1)],10,oe))),128))])])]))}},de={class:"flex items-center"},ce={class:"flex w-full justify-around items-center"},pe={class:"flex flex-col"},ue={class:"text-lg whitespace-nowrap overflow-ellipsis overflow-hidden text-[var(--theme-title)]"},_e={class:"flex gap-2 items-center"},me={class:"text-[var(--theme-text)]"},he={class:"flex gap-2 items-center"},ve={class:"text-[var(--theme-text)]"},fe={class:"w-full text-center mt-5"},xe={__name:"PlanPaymentModal",props:{planData:{type:Object,required:!0},onClose:{type:Function,required:!0}},setup(h){const o=A(),l=h,f=()=>{l.onClose()},c=x([]),u=x(0),_=x(null),w=x(null),y=r=>({month_price:t("plan.period.month"),quarter_price:t("plan.period.quarter"),half_year_price:t("plan.period.halfYear"),year_price:t("plan.period.year"),two_year_price:t("plan.period.twoYear"),three_year_price:t("plan.period.threeYear"),onetime_price:t("plan.period.onetime"),reset_price:t("plan.period.reset")})[r]||!1;F(l.planData,r=>{for(const d in r)r[d]!==null&&y(d)&&c.value.push({title:y(d),name:d,number:r[d]})},{immediate:!0});const i=({code:r,discount:d})=>{w.value=r,_.value=d,g(t("plan.coupon.validateSuccess"),null,200)},s=r=>{u.value=r},n=()=>{let r=c.value[u.value].name,d=l.planData.id;K(r,d,w.value).then(b=>{g(t("plan.order.createSuccess"),t("plan.order.createSuccessPrompt"),200),l.onClose(),S(b.data.data)}).catch(b=>{g(t("plan.order.submitFailed"),b.data.message,400,4e3),b.data.message.indexOf("未付款")!==-1&&R().then(k=>{o.orders=k.data.data;for(const D of k.data.data)D.status===0&&S(D.trade_no)})})};return(r,d)=>(m(),N(E,{title:p(t)("plan.order.title"),"gradient-id":"plan-gradient","on-close":f},{default:j(()=>[e("div",de,[d[2]||(d[2]=e("img",{class:"rounded-lg lg:w-24 w-20",src:J,alt:""},null,-1)),e("div",ce,[e("div",pe,[e("h1",ue,a(l.planData.name),1),e("div",null,[e("div",_e,[d[0]||(d[0]=e("span",{class:"border-4 border-green-500 w-0 h-0 rounded-full"},null,-1)),e("p",me,a(p(t)("plan.details.traffic"))+a(l.planData.transfer_enable)+"G ",1)]),e("div",he,[d[1]||(d[1]=e("span",{class:"border-4 border-green-500 w-0 h-0 rounded-full"},null,-1)),e("p",ve,a(p(t)("plan.details.speedLimit"))+a(l.planData.speed_limit===null?p(t)("plan.details.speedUnlimited"):l.planData.speed_limit)+"/MS ",1)])])])])]),M(ee,{"plan-id":l.planData.id,onCouponValidated:i},null,8,["plan-id"]),M(ie,{periods:c.value,"selected-index":u.value,"discount-info":_.value,onPeriodSelect:s},null,8,["periods","selected-index","discount-info"]),e("div",fe,[e("button",{onClick:n,class:"w-[80%] p-2 bg-green-500 text-white rounded-lg hover:opacity-80 transition-opacity"},a(p(t)("plan.order.button")),1)])]),_:1},8,["title"]))}},ge=h=>{try{const l=O(xe,{planData:h,onClose:()=>{I(null,document.getElementById("modal"))}});I(l,document.getElementById("modal"))}catch{g("打开支付窗口失败","请稍后重试",400)}};const we={class:"text-[var(--theme-title)] h-full overflow-y-scroll"},ye={class:"text-2xl mb-5"},be={class:"grid"},Ce={class:"overflow-hidden"},Pe={key:0,class:"bg-[var(--theme-com)] w-full items-center lg:p-14 py-5 h-full flex gap-10"},$e={class:"lg:w-[70%] w-full px-5 h-full"},ke={class:"relative flex flex-col h-full"},De={class:"lg:ml-5"},Me={class:"w-full lg:text-xl text-xl p-2 rounded-lg inline-block"},Ie={class:"flex items-center"},Se={class:"p-5 sm:max-h-[250px] sm:overflow-y-auto overflow-x-auto"},Fe={class:"flex flex-row flex-nowrap gap-5 sm:flex-wrap"},Le=["onClick"],qe={class:"whitespace-nowrap overflow-hidden overflow-ellipsis"},Be={class:"absolute -top-3 text-white text-sm bg-[#08CD7C] rounded-lg px-2 left-0"},Ve={class:"flex flex-col items-center gap-0"},Ae={class:"text-[13px] whitespace-nowrap text-neutral-400"},Ne={class:"flex flex-col items-center gap-0"},je={class:"text-[13px] whitespace-nowrap text-neutral-400"},Oe={class:"bg-[var(--theme-com-item)] mt-2 sm:flex-1 w-full sm:overflow-auto sm:ml-5 mb-2 p-5 rounded-lg"},Ye=["innerHTML"],ze={class:"px-5"},Te={class:"text-xl mb-2"},Ue={class:"flex gap-5 items-center text-lg"},Ee={class:"flex gap-5 items-center text-lg"},Ge={class:"w-full overflow-auto"},Ke={class:"flex gap-5"},Re={class:"price-tag"},He={class:"whitespace-nowrap text-sm"},Je={class:"pb-24 sm:pb-5 sm:mt-5"},Qe={class:"absolute top-0 right-0 px-5 py-1 text-xs tracki text-center uppercase whitespace-no-wrap origin-bottom-left transform rotate-45 -translate-y-full translate-x-1/3 bg-violet-400"},We={__name:"PlanPage",setup(h){const o=x(-1),l=x(null),f=i=>{if(typeof i=="number"){const s=i.toString(),n=s.slice(0,-2),r=s.slice(-2);return`${n}.${r}`}return i},c=i=>({month_price:t("plan.period.month"),quarter_price:t("plan.period.quarter"),half_year_price:t("plan.period.halfYear"),year_price:t("plan.period.year"),two_year_price:t("plan.period.twoYear"),three_year_price:t("plan.period.threeYear"),onetime_price:t("plan.period.onetime"),reset_price:t("plan.period.reset")})[i]||!1;z(()=>{L().then(i=>{Array.from(i.data.data).length>0&&(o.value=0,l.value=Array.from(i.data.data))})});const u=x(),_=x([]);F(o,i=>{u.value=l.value[i],_.value=[];for(const s in u.value)if(u.value[s]!==null){const n=c(s);n&&_.value.push({name:n,title:s,number:u.value[s]})}});const w=i=>{let s=[];for(const n in i)if(n.indexOf("_price")!==-1&&i[n]!==null){s[0]=c(n),s[1]=f(i[n]);break}return s},y=()=>{if(!l.value||o.value<0){g(t("plan.error.selectPlan"),null,400);return}const i=l.value[o.value];if(!i){g(t("plan.error.invalidPlan"),null,400);return}ge(i)};return(i,s)=>(m(),v("div",we,[e("h1",ye,a(p(t)("plan.title")),1),e("div",be,[e("div",Ce,[l.value!==null?(m(),v("div",Pe,[s[4]||(s[4]=e("div",{class:"hidden lg:block flex-1"},[e("img",{src:H,alt:""})],-1)),e("div",$e,[e("div",ke,[e("div",De,[e("p",Me,a(p(t)("plan.details.name"))+a(l.value[o.value].name),1)]),e("div",Ie,[e("div",Se,[e("ul",Fe,[(m(!0),v(C,null,P(l.value,(n,r)=>(m(),v("li",{key:r,class:$([r===o.value?"border-[#08CD7C] border-2":"border-2","relative p-2 px-5 shadow-sm shadow-[#08CD7C] w-36 text-center rounded-xl cursor-pointer hover:border-[#08CD7C]"]),onClick:d=>o.value=r},[e("div",null,[e("p",qe,a(n.name),1),e("span",Be,a(w(n)[1])+"/"+a(w(n)[0]),1),e("div",Ve,[e("span",Ae,a(n.transfer_enable)+"G ",1)]),e("div",Ne,[e("span",je,a(n.speed_limit==null?"无限制":n.speed_limit)+"/MS ",1)])]),(m(),v("svg",{class:$([r===o.value?"block":"hidden","icon absolute top-0 right-0"]),t:"1693782622038",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4230",width:"20",height:"20"},s[0]||(s[0]=[e("path",{d:"M512 929.959184c-230.4 0-417.959184-187.559184-417.959184-417.959184s187.559184-417.959184 417.959184-417.959184 417.959184 187.559184 417.959184 417.959184-187.559184 417.959184-417.959184 417.959184z",fill:"#08CD7C","p-id":"4231","data-spm-anchor-id":"a313x.search_index.0.i2.3aaf3a810MN6jV",class:"selected"},null,-1),e("path",{d:"M459.755102 637.387755c-5.22449 0-10.44898-2.089796-14.628571-6.269388l-104.489796-104.489796c-8.359184-8.359184-8.359184-21.420408 0-29.779591 8.359184-8.359184 21.420408-8.359184 29.779592 0l104.489795 104.489796c8.359184 8.359184 8.359184 21.420408 0 29.779591-4.702041 4.179592-9.926531 6.269388-15.15102 6.269388z",fill:"#DCFFFA","p-id":"4232"},null,-1),e("path",{d:"M459.755102 637.387755c-5.22449 0-10.44898-2.089796-14.628571-6.269388-8.359184-8.359184-8.359184-21.420408 0-29.779591l208.979591-208.979592c8.359184-8.359184 21.420408-8.359184 29.779592 0 8.359184 8.359184 8.359184 21.420408 0 29.779592l-208.979592 208.979591c-4.702041 4.179592-9.926531 6.269388-15.15102 6.269388z",fill:"#DCFFFA","p-id":"4233"},null,-1)]),2))],10,Le))),128))])])]),e("div",Oe,[e("div",{innerHTML:l.value[o.value].content},null,8,Ye)]),e("div",ze,[e("p",Te,a(p(t)("plan.details.configuration")),1),e("div",Ue,[s[1]||(s[1]=e("span",{class:"dot-indicator"},null,-1)),e("p",null,a(p(t)("plan.details.traffic"))+a(l.value[o.value].transfer_enable)+"G",1)]),e("div",Ee,[s[2]||(s[2]=e("span",{class:"dot-indicator"},null,-1)),e("p",null,a(p(t)("plan.details.speedLimit"))+" "+a(l.value[o.value].speed_limit==null?p(t)("plan.details.speedUnlimited"):l.value[o.value].speed_limit)+"/MS ",1)]),e("div",Ge,[e("ul",Ke,[(m(!0),v(C,null,P(_.value,(n,r)=>(m(),v("li",{key:r,class:"rounded-md py-4 text-sm focus:relative text-gray-400 hover:text-gray-200 cursor-pointer"},[e("span",Re,[s[3]||(s[3]=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"-ms-1 me-1.5 h-4 w-4"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("p",He,a(n.name)+": "+a(f(n.number)),1)])]))),128))])])]),e("div",Je,[e("button",{type:"button",onClick:y,class:"relative px-8 py-4 ml-4 overflow-hidden font-semibold rounded bg-[#08CD7C] text-gray-900"},[T(a(p(t)("plan.details.payButton"))+" ",1),e("span",Qe,a(p(t)("plan.details.payButtonTag")),1)])])])])])):U("",!0)])])]))}},at=Y(We,[["__scopeId","data-v-98bcb35a"]]);export{at as default};
